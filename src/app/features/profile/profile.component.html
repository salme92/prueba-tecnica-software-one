<section class="profile">
  <mat-card>
    <h2>Perfil de usuario</h2>
    <form [formGroup]="form" (ngSubmit)="submit()">
      <mat-form-field appearance="outline" class="profile__field">
        <mat-label>Nombre</mat-label>
        <input
          #nameInput
          matInput
          placeholder="Tu nombre completo"
          formControlName="name"
        />
        <mat-error *ngIf="form.get('name')?.invalid">
          {{ getErrorMessage('name') }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="profile__field">
        <mat-label>Email</mat-label>
        <input
          matInput
          placeholder="ejemplo@correo.com"
          formControlName="email"
        />
        <mat-icon
          matSuffix
          *ngIf="form.get('email')?.pending"
          class="spinner-icon"
          >hourglass_empty</mat-icon
        >
        <mat-error *ngIf="form.get('email')?.invalid">
          {{ getErrorMessage('email') }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="profile__field">
        <mat-label>Nombre de usuario</mat-label>
        <input
          matInput
          placeholder="usuario123"
          formControlName="username"
        />
        <mat-error *ngIf="form.get('username')?.invalid">
          {{ getErrorMessage('username') }}
        </mat-error>
      </mat-form-field>

      <div class="profile__actions">
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="saving || form.invalid"
        >
          {{ saving ? 'Guardando...' : 'Guardar cambios' }}
        </button>
      </div>
    </form>

    <div *ngIf="saved" class="profile__saved">
      âœ… Perfil guardado correctamente
    </div>
  </mat-card>
</section>
